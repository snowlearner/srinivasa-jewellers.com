<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Homepage</title>

  <style>
    /* Reset some default styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .navbar {
      width: 100%;
      height: 75px;
      margin: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #333;
      padding: 0 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .icon {
      display: flex;
      align-items: center;
    }


    .logo {
      color: #ff7200;
      font-size: 30px;
      font-family: 'Arial', sans-serif;
      padding-left: 5px;
      height: 25px;
    }

    .menu ul {
      display: flex;
      list-style: none;
      gap: 20px;
      margin-left: auto;
    }

    .menu ul li {
      display: inline-block;
    }

    .menu ul li a {
      text-decoration: none;
      color: white;
      font-weight: bold;
      font-size: 16px;
      transition: all 0.3s ease-in-out;
    }

    .menu ul li a:hover {
      color: #ff7200;
      text-transform: uppercase;
    }

    .search input.srch {
      padding: 10px 20px;
      border: 2px solid #ff7200;
      background-color: transparent;
      color: white;
      font-size: 16px;
      width: 160px;
      border-radius: 25px;
      margin-right: 10px;
      transition: width 0.4s ease-in-out;
    }

    .search input.srch:focus {
      outline: none;
      width: 400px;
    }


    .btn {
      padding: 10px 20px;
      background-color: #ff7200;
      border: none;
      color: white;
      font-size: 16px;
      width: 85px;
      cursor: pointer;
      border-radius: 25px;
      transition: background-color 0.3s ease-in-out;
    }



    .btn:hover {
      background-color: #e65800;
    }

    /* ----------------------------------- */

    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(to right, #e2e2e2, #c9d6ff);
      color: #333;
      padding: 0px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;

    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: #4a90e2;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    h1:hover {
      color: #357ab7;
      /* Change color on hover */
    }

    h2 {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 30px;
      color: #333;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    h2:hover {
      color: #4a90e2;
      /* Change color on hover */
    }

    /* Card Layout for User Details */
    .user-details-card {
      background-color: cyan;
      border-radius: 12px;
      box-shadow: 12px 10px 10px rgba(0.2, 0.9, 0.9, 0.1);
      padding: 20px;
      width: 520px;
      margin-bottom: 80px;
      margin-left: 100px;
      text-align: left;
      transition: transform 0.3s ease;
    }

    .user-details-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .user-details-card h3 {
      margin-bottom: 10px;
      color: goldenrod;
      font-size: 1.5rem;
      font-weight: bolder;
    }

    .user-details-card div {
      margin-bottom: 10px;
      font-size: 1.2rem;
    }

    .user-details-card span {
      font-weight: bold;
      color: mediumblue;
    }

    /* .updated-price-details-card {
      background-color: cyan;
      border-radius: 12px;
      box-shadow: 12px 10px 10px rgba(0.2, 0.9, 0.9, 0.1);
      padding: 35px;
      width: 525px;
      margin-bottom: 38px;
      margin-top: -255px;
      margin-left: 655px;
      display: inherit;
      text-align: left;
      transition: transform 0.3s ease;
      justify-content: space-between;
      flex-direction: row;
    } */

    .updated-price-details-card {
      background-color: cyan;
      border-radius: 12px;
      box-shadow: 12px 10px 10px rgba(0.2, 0.9, 0.9, 0.1);
      padding: 11px 10px;
      width: 365px;
      margin-bottom: 38px;
      margin-top: -260px;
      margin-left: 655px;
      display: inherit;
      text-align: left;
      transition: transform 0.3s ease;
      justify-content: space-between;
      flex-direction: row;
    }

    .updated-price-details-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .updated-price-details-card h2 {
      margin-bottom: 10px;
      color: goldenrod;
      font-size: 1.5rem;
      font-weight: bolder;
    }

    .updated-price-details-card div {
      margin-bottom: -10px;
      font-size: 1.2rem;
      font-weight: bolder;
      margin-top: -13px;
    }

    .updated-price-details-card span {
      font-weight: bold;
      color: mediumblue;
    }

    /* Container for Forms */
    .form-container {
      display: flex;
      gap: 30px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 30px;
    }

    .form-card {
      background-color: transparent;
      border-radius: 12px;
      box-shadow: 0 2px 20px rgba(0, 0, 0.2, 0.9);
      padding: 20px;
      width: 521px;
      margin-bottom: 20px;
      transition: transform 0.3s ease;
    }

    .form-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .input-group {
      margin-bottom: 20px;
    }

    label {
      font-size: 1.1rem;
      margin-bottom: 8px;
      color: #333;
    }

    input,
    select,
    button {
      width: 100%;
      padding: 5px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 10px;
      font-size: 1.1rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      background-color: lightcyan;
    }

    input:focus,
    select:focus,
    button:focus {
      outline: none;
      box-shadow: 0 0 8px rgba(72, 148, 226, 0.7);
    }

    button {
      background-color: #4a90e2;
      color: white;
      font-weight: bold;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      width: 200px;
    }

    button:hover {
      background-color: #357ab7;
      transform: scale(1.05);
    }

    button:active {
      background-color: #286a99;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      body {
        padding: 20px;
      }

      h1 {
        font-size: 2.2rem;
      }

      h2 {
        font-size: 1.5rem;
      }

      .user-details-card,
      .form-card {
        width: 100%;
        max-width: 400px;
        margin: 10px 0;
      }

      .form-container {
        flex-direction: column;
        align-items: center;
      }
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.8rem;
      }

      h2 {
        font-size: 1.3rem;
      }

      button {
        font-size: 1rem;
        padding: 10px;
      }

      input,
      select {
        font-size: 1rem;
        padding: 10px;
      }
    }

    /* Styles for the container to display the data side by side */
    #priceDetails {
      display: flexbox;
      flex-wrap: wrap;
      gap: 5px;
      justify-content: space-between;
    }

    /* Styles for each individual price detail */
    .price-item {
      width: 60%;
      background-color: gainsboro;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      margin-bottom: 5px;
      display: ruby-text;
    }

    .price-item strong {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }

    /* Make sure to break into a new row on very small screens */
    @media (max-width: 600px) {
      .price-item {
        width: 100%;
      }
    }

    /*------------------------------------*/
    /* Center the logout and customer action buttons */
    .log-out-button,
    .admin-contact-details>div {
      display: flex;
      justify-content: center;
      /* Center buttons horizontally */
      align-items: center;
      /* Vertically align */
      margin-top: 30px;
      /* Add some space above the buttons */
      gap: 20px;
      /* Space between the buttons */
    }

    button {
      padding: 10px 20px;
      background-color: orange;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
      border-radius: 25px;
      transition: background-color 0.3s ease-in-out;
    }

    button:hover {
      background-color: #e65800;
    }

    /* Styling for the individual buttons to ensure consistency */
    button#logout {
      width: 200px;
      text-align: center;
    }

    button#viewCustomersBtn,
    button#deleteAllCustomersBtn {
      width: 200px;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="main">
    <div class="navbar">
      <div class="icon">
        <h2 class="logo">
          <img src="image2.jpg" alt="SJ" width="50" height="50" />
        </h2>
      </div>
      <div class="menu">
        <ul>

          <li><a href="about.html">ABOUT</a></li>
          <li><a href="gallery.html">GALLERY</a></li>
          <li><a href="products.html">PRODUCTS</a></li>
          <li><a href="contact.html">CONTACT</a></li>
          <li><a href="index.html">LOGIN</a></li>

        </ul>
      </div>

      <div class="search">
        <input class="srch" type="search" name="" placeholder="Type To text" />
        <a href="#">
          <button class="btn">Search</button>
        </a>
      </div>
    </div>
    <br><br>
    <h1>Welcome to the Homepage</h1>

    <!-- User Details Section -->
    <div class="user-details-card">
      <h3>User Details</h3>
      <div>
        <strong>First Name:</strong> <span id="loggedUserFName">John</span>
      </div>
      <div>
        <strong>Last Name:</strong> <span id="loggedUserLName">Doe</span>
      </div>
      <div>
        <strong>Email:</strong> <span id="loggedUserEmail">john.doe@example.com</span>
      </div>
    </div>
    <!-- Display Price details updated -->
    <div class="updated-price-details-card">
      <div id="priceDetails">
        <!-- Price data will be displayed here -->
      </div>
    </div>
    <!-- ------------------------------ -->

    <!-- Gold and Silver Price Update Form -->
    <div class="form-container">
      <div class="form-card">
        <h2>Please Update the Prices for Gold and Silver</h2>
        <form id="priceForm">
          <div class="input-group">
            <label for="price18Karat">Price 18 Karat Gold per Gram:</label>
            <input type="number" id="price18Karat" required />
          </div>
          <div class="input-group">
            <label for="price20Karat">Price 20 Karat Gold per Gram:</label>
            <input type="number" id="price20Karat" required />
          </div>
          <div class="input-group">
            <label for="price22Karat">Price 22 Karat Gold per Gram:</label>
            <input type="number" id="price22Karat" required />
          </div>
          <div class="input-group">
            <label for="price24Karat">Price 24 Karat Gold per Gram:</label>
            <input type="number" id="price24Karat" required />
          </div>
          <div class="input-group">
            <label for="priceSilver1">Price Silver 1 per Gram:</label>
            <input type="number" id="priceSilver1" required />
          </div>
          <div class="input-group">
            <label for="priceSilver2">Price Silver 2 per Gram:</label>
            <input type="number" id="priceSilver2" required />
          </div>
          <!-- <div class="input-group">
            <label for="wastageCharges">Wastage Charges (%):</label>
            <input type="number" id="wastageCharges" required />
          </div>
          <div class="input-group">
            <label for="makingCharges">Making Charges per Gram:</label>
            <input type="number" id="makingCharges" required />
          </div> -->
          <div class="input-group">
            <label for="goldwastageCharges">Gold Wastage Charges (%):</label>
            <input type="number" id="goldwastageCharges" required />
          </div>
          <div class="input-group">
            <label for="goldmakingCharges">Gold Making Charges per Gram:</label>
            <input type="number" id="goldmakingCharges" required />
          </div>
          <div class="input-group">
            <label for="wastageChargesSilver">Silver Wastage Charges (%):</label>
            <input type="number" id="wastageChargesSilver" required />
          </div>
          <div class="input-group">
            <label for="makingChargesSilver">Silver Making Charges per Gram:</label>
            <input type="number" id="makingChargesSilver" required />
          </div>

          <button type="submit" id="savePrices">Save Prices</button>
        </form>
      </div>

      <!-- Add New Product Form -->
      <div class="form-card">
        <h2>Add a New Product</h2>
        <form id="addProductForm">
          <div class="input-group">
            <label for="product-category">Product Category</label>
            <select id="product-category" required>
              <option value="24 Karat">24 Karat</option>
              <option value="22 Karat">22 Karat</option>
              <option value="20 Karat">20 Karat</option>
              <option value="18 Karat">18 Karat</option>
              <option value="Silver 1">Silver 1</option>
              <option value="Silver 2">Silver 2</option>
            </select>
          </div>
          <div class="input-group">
            <label for="product-name">Product Name</label>
            <input type="text" id="product-name" required />
          </div>
          <div class="input-group">
            <label for="product-weight">Product Weight</label>
            <input type="number" id="product-weight" step="0.001" required />
          </div>
          <div class="input-group">
            <label for="product-image-url">Product Image URL</label>
            <input type="text" id="product-image-url" placeholder="Enter image URL" required />
          </div>
          <button type="submit">Add Product</button>
        </form>
        <!-- ---------------------- -->
        <h2>Delete a Product</h2>
        <form id="deleteProductForm">
          <label for="product-select">Select Product to Delete</label>
          <select id="product-select" required>
            <!-- Product options will be populated dynamically -->
          </select>

          <button type="submit">Delete Product</button>
        </form>

        <!-- ---------------------   add images ------------- -->
        <h2>Add an Image</h2>
        <form id="addImageForm">
          <div class="input-group">
            <label for="image-url">Image URL:</label>
            <input type="text" id="image-url" placeholder="Enter image URL" required />
          </div>
          <button type="submit">Add Image</button>
        </form>
        <!-- ---------------------   Delete images ------------- -->
        <h2>Delete an Image</h2>
        <form id="deleteImageForm">
          <label for="image-select">Select Image to Delete</label>
          <select id="image-select" required>
            <!-- Image options will be populated dynamically -->
          </select>
          <button type="submit">Delete Image</button>
        </form>
      </div>

    </div>
    
    <!----------------------- Logout Button---------------- -->
    <div class="log-out-button">

      <button id="logout">Logout</button>
    </div>

    <!-- ---------------------------------- contact details----------------- -->

    <div class="admin-contact-details">
      <h2>Customer Who Want to Contact Us</h2>
      <div id="contactList">
        <!-- Contact details will be dynamically populated here -->
      </div>
      <div>
        <button id="viewCustomersBtn">View Customers</button>
        <button id="deleteAllCustomersBtn">Delete Customers</button>
      </div>


      <!-- Firebase SDK -->
      <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
        import { getFirestore, doc, collection, getDocs, getDoc, writeBatch } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyDt_ePCpK6FVGe4tmJgMaz-DmlvGQm5wk4",
          authDomain: "srinivasa-jewellers.firebaseapp.com",
          projectId: "srinivasa-jewellers",
          storageBucket: "srinivasa-jewellers.firebasestorage.app",
          messagingSenderId: "861877666540",
          appId: "1:861877666540:web:f1c4557fdb19732ffc1bc9",
          measurementId: "G-WV4L6HXEXF"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Button to show customers' contact details
        const viewCustomersBtn = document.getElementById('viewCustomersBtn');
        const contactListSection = document.getElementById('contactListSection');
        const contactListDiv = document.getElementById("contactList");

        // Function to fetch and display contact details from Firestore
        async function fetchContactDetails() {
          // Ensure the contactListSection exists
          if (contactListSection) {
            contactListSection.style.display = "block"; // Show the contact list section
          }

          try {
            // Get the customer data from Firestore
            const querySnapshot = await getDocs(collection(db, "customerData"));

            // Check if there is data
            if (querySnapshot.empty) {
              contactListDiv.innerHTML = "<p>No contact details available.</p>";
              return;
            }

            // Loop through the documents and display contact details
            contactListDiv.innerHTML = ''; // Clear previous data
            querySnapshot.forEach((doc) => {
              const data = doc.data();

              // Check if all necessary fields are present
              if (data.firstName && data.lastName && data.email && data.phone) {
                const contactDiv = document.createElement("div");
                contactDiv.classList.add("contact-details");

                // Append contact details to the contact list div
                contactDiv.innerHTML = `
          <div><strong>First Name:</strong> ${data.firstName}</div>
          <div><strong>Last Name:</strong> ${data.lastName}</div>
          <div><strong>Email:</strong> ${data.email}</div>
          <div><strong>Phone:</strong> ${data.phone}</div>
          <hr>
        `;
                contactListDiv.appendChild(contactDiv);
              } else {
                console.error(`Missing fields for document: ${doc.id}`, data); // Log the missing fields and document ID
              }
            });

          } catch (error) {
            console.error("Error fetching contact details: ", error);
            contactListDiv.innerHTML = "<p>Error fetching data.</p>";
          }
        }

        // Function to delete all customer details from Firestore
        async function deleteAllCustomerData() {
          const confirmDelete = confirm("Are you sure you want to delete all customer data?");
          if (!confirmDelete) return;

          try {
            const querySnapshot = await getDocs(collection(db, "customerData"));
            const batch = writeBatch(db); // Initialize batch

            querySnapshot.forEach((doc) => {
              batch.delete(doc.ref); // Add delete operation to batch for each document
            });

            await batch.commit(); // Commit all batch operations in a single request
            console.log("All customer data deleted.");
            alert("All customer data deleted.");
            contactListDiv.innerHTML = "<p>No contact details available.</p>"; // Clear contact list display
          } catch (error) {
            console.error("Error deleting customer data: ", error);
            alert("Error deleting customer data.");
          }
        }

        // Add event listener for the "Delete All Customers" button
        document.getElementById("deleteAllCustomersBtn").addEventListener("click", deleteAllCustomerData);
        // Event listener for the "View Customers" button
        viewCustomersBtn.addEventListener('click', fetchContactDetails);

        // -------------------Display updated price details-----------------------------//

        // <!-- Firebase SDK (Module version) -->

        // Reference to Firestore document
        const priceDocRef = doc(db, "priceData", "r8NuFZ36WWbuuBv5muZDXgRJIxB2");

        // Fetch price data and display
        async function fetchAndDisplayPrices() {
          try {
            const docSnapshot = await getDoc(priceDocRef);
            if (docSnapshot.exists()) {
              const priceData = docSnapshot.data();

              // Extract data from Firestore
              const {
                goldmakingCharges, price18Karat, price20Karat,
                price22Karat, price24Karat, priceSilver1,
                priceSilver2, goldwastageCharges, wastageChargesSilver, makingChargesSilver
              } = priceData;

              // Get current timestamp
              const timestamp = new Date().toLocaleString();
              //<div class="price-item"><strong>Last Updated: ${timestamp}</div>
              // Display price data and timestamp
              document.getElementById('priceDetails').innerHTML = `
        <h2>Price Details per gram</h2>
            <div class="price-item"><strong>18 Karat: ₹${price18Karat}</div> 
            <div class="price-item"><strong>20 Karat: ₹${price20Karat}</div>
            <div class="price-item"><strong>22 Karat: ₹${price22Karat}</div>
            <div class="price-item"><strong>24 Karat: ₹${price24Karat}</div>
            <div class="price-item"><strong>Silver 1: ₹${priceSilver1}</div>
            <div class="price-item"><strong>Silver 2: ₹${priceSilver2}</div>
            <div class="price-item"><strong>Gold Wastage Charges: ₹${goldwastageCharges}%</div>
            <div class="price-item"><strong>Gold Making Charges: ₹${goldmakingCharges}</div>
           <div class="price-item"><strong>Silver Wastage Charges: ₹${wastageChargesSilver}%</div>
            <div class="price-item"><strong>Silver Making Charges: ₹${makingChargesSilver}</div>
            
          `;
            } else {
              console.log("No such document!");
            }
          } catch (error) {
            console.error("Error fetching price data: ", error);
          }
        }

        // Call the function to display prices when the page loads
        fetchAndDisplayPrices();

      </script>

      <script type="module" src="./homepage.js"></script>
      <script type="module" src="https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js"></script>
      <script type="module" src="https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js"></script>
      <script type="module" src="https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js"></script>

</body>

</html>
